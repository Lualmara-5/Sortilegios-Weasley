<div class="perfil-container" *ngIf="usuarioActual; else noLogin">
  <!-- ü™Ñ Identidad m√°gica -->
  <section class="identidad-magica">
    <h2>Mi identidad m√°gica</h2>
    <div class="avatar-container">
      <img src="../../../assets/img/avatars/default.png" alt="Avatar m√°gico" class="avatar-icon" />
    </div>

    <div class="info-usuario">
      <p><strong>Nombre:</strong> {{ usuarioActual.usuario.username }}</p>
      <p><strong>Alias:</strong> {{ aliasMagico }}</p>
      <p><strong>Direcci√≥n:</strong> {{ direccionMagica }}</p>
      <p *ngIf="usuarioActual.usuario.mail"><strong>Email:</strong> {{ usuarioActual.usuario.mail }}</p>
      <p *ngIf="usuarioActual.usuario.telefono"><strong>Tel√©fono:</strong> {{ usuarioActual.usuario.telefono }}</p>
    </div>

    <div class="input-group">
      <label for="alias">Editar alias m√°gico</label>
      <input type="text" id="alias" [(ngModel)]="aliasMagico" />
    </div>

    <div class="input-group">
      <label for="direccion">Editar direcci√≥n m√°gica</label>
      <input type="text" id="direccion" [(ngModel)]="direccionMagica" />
    </div>

    <div class="acciones">
      <!-- üî• Cambiado a guardarCambios() -->
      <button type="button" class="btn-primario" (click)="guardarCambios()">Guardar cambios</button>
      <button type="button" class="btn-salir" (click)="salir()">Salir</button>
    </div>
  </section>

  <!-- üìú Mis pedidos -->
  <section class="mis-pedidos">
    <h2>Mis pedidos</h2>
    <table class="tabla-pedidos">
      <thead>
        <tr>
          <th scope="col">Fecha</th>
          <th scope="col">Productos</th>
          <th scope="col">Estado</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let pedido of pedidos">
          <td>{{ pedido.fecha }}</td>
          <td>{{ pedido.producto }}</td>
          <td
            class="estado"
            [ngClass]="{
              entregado: pedido.estado === 'Entregado',
              camino: pedido.estado === 'En camino'
            }"
          >
            {{ pedido.estado }}
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- üíñ Lista de deseos -->
  <section class="lista-deseos">
    <h2>Mi lista de deseos</h2>

    <div *ngIf="listaDeseos && listaDeseos.length > 0; else sinDeseos">
      <div class="wishlist-grid">
        <div class="producto-deseo" *ngFor="let item of listaDeseos">
          <img [src]="item.image" [alt]="item.name" />
          <div class="info">
            <h3>{{ item.name }}</h3>
            <div class="botones">
              <button class="btn-caldero" (click)="agregarAlCaldero(item)">
                üßô‚Äç‚ôÇÔ∏è A√±adir al Caldero
              </button>
              <button class="btn-eliminar" (click)="eliminarDeseo(item)">
                ‚ùå Eliminar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template #sinDeseos>
      <p class="vacio">Tu lista de deseos est√° vac√≠a ü™Ñ</p>
    </ng-template>
  </section>
</div>

<!-- üí° Cuando no hay usuario logueado -->
<ng-template #noLogin>
  <div class="no-login">
    <h2>No has iniciado sesi√≥n</h2>
    <p>Por favor inicia sesi√≥n para acceder a tu perfil m√°gico.</p>
    <button class="btn-primario" routerLink="/login">Ir al inicio de sesi√≥n</button>
  </div>
</ng-template>
